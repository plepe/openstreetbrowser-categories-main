type: "overpass"
query: 
  15: |
    (
    nwr[historic];
    nwr[tourism~'^(attraction|artwork)$'];
    nwr[heritage];
    nwr[amenity~'^(fountain|arts_centre|place_of_worship|theatre)$'];
    )
feature: 
  pre: |
    {% set color = 'red' %}
    {% set str = 'No image, wikimedia_commons or wikidata' %}

    {% if tags.wikidata %}
      {% set color = 'blue' %}
      {% set str = 'has wikidata tag' %}
      {% set wikidata = tags.wikidata|wikidataEntity %}

      {% if wikidata.claims.P18|length == 0 %}
        {% set color = '#007fff' %}
        {% set str = 'has wikidata tag, but wikidata object does not have an image' %}
      {% endif %}

      {% if wikidata.claims.P31[0].mainsnak.datavalue.value.id in ['Q5'] %}
        {% set color = 'magenta' %}
        {% set str = "wikidata points to a human, should most likely be 'subject:wikidata'" %}
      {% endif %}

    {% elseif tags.wikipedia %}
      {% set color = '#af00ff' %}
      {% set str = 'wikipedia tag found without corresponding wikidata tag' %}

    {% elseif tags.wikimedia_commons or tags.image %}
      {% set color = 'cyan' %}
      {% set str = tags.wikimedia_commons ? 'has wikimedia_commons tag' : 'has image tag' %}

    {% endif %}

  body: |
    {{ str }}

  style:
    color: |
      {{ color }}

  description: |
    {% if tags.historic and tags.historic != 'yes' %}
      {{ tagTransList('historic', tags.historic) }}
      {% if tags.historic == 'memorial' and tags.memorial %}
        ({{ tagTransList('memorial', tags.memorial) }})
      {% endif %}
    {% elseif tags.tourism %}
      {{ tagTransList('tourism', tags.tourism) }}
    {% elseif tags.amenity %}
      {{ tagTrans('amenity', tags.amenity) }}
    {% elseif tags.heritage %}
      {{ keyTrans('heritage') }}
    {% endif %}
  markerSymbol: "{{ markerPointer({ fillColor: color })|raw }}"
  listMarkerSymbol: "{{ markerCircle({ fillColor: color })|raw }}"
filter: 
  type: 
    name: "{{ trans('filter:type') }}"
    show_default: "true"
    query: "nwr[{{ value }}]"
    type: "select"
    key: "tourism"
    values: |
      {% for kv, d in const.types %}
        {% set k = kv|split('=')[0] %}
        {% set v = kv|split('=')[1] %}
        {% set d = d|default({}) %}
        <option value='{{ kv }}' query='nwr[{{ d.query|default(kv) }}]'>{% if d.trans %}{{ trans(d.trans) }}{% elseif not v %}{{ keyTrans(k) }}{% else %}{{ tagTrans(k, v) }}{% endif %}</option>
      {% endfor %}
    op: "has"
info: |
  <table>
      <tr>
        <td>
          {{ markerCircle({ fillColor: 'red' })|raw }}
        </td>
        <td>No image, wikimedia_commons or wikidata</td>
      </tr>
      <tr>
        <td>
          {{ markerCircle({ fillColor: 'magenta' })|raw }}
        </td>
        <td>wikidata tag points to a human, should most likely be 'subject:wikidata'</td>
      </tr>
      <tr>
        <td>
          {{ markerCircle({ fillColor: '#af00ff' })|raw }}
        </td>
        <td>wikipedia tag found without corresponding wikidata tag</td>
      </tr>
      <tr>
        <td>
          {{ markerCircle({ fillColor: 'cyan' })|raw }}
        </td>
        <td>image or wikimedia_commons tag but no wikidata</td>
      </tr>
      <tr>
        <td>
          {{ markerCircle({ fillColor: '#007fff' })|raw }}
        </td>
        <td>has wikidata tag, but wikidata object does not have an image</td>
      </tr>
      <tr>
        <td>
          {{ markerCircle({ fillColor: 'blue' })|raw }}
        </td>
        <td>has wikidata tag</td>
      </tr>
  </table>

  This category lists artwork, memorials, historic and heritage protected objects. These should have an <a target="_blank" href="https://wiki.openstreetmap.org/wiki/Key:image">image</a> or <a target="_blank" href="https://wiki.openstreetmap.org/wiki/Key:wikimedia_commons">wikimedia_commons</a> tag, or (even better) a <a target="_blank" href="https://wiki.openstreetmap.org/wiki/Key:wikidata">wikidata</a> tag pointing to the object's entry.<br>
  Memorials erroneously often have a wikidata (and wikipedia) tag of the person/event, which should be changed to <a target="_blank" href="https://wiki.openstreetmap.org/wiki/Key:wikidata#Secondary_Wikidata_links">subject:wikidata</a> resp. <a target="_blank" href="https://wiki.openstreetmap.org/wiki/Key:wikipedia#Secondary_Wikipedia_links">subject:wikipedia</a>".
const:
  types:
    tourism=artwork:
    tourism=attraction:
    historic=memorial:
    historic=monument:
    historic=wayside_cross:
    historic=wayside_shrine:
    historic=building:
    amenity=fountain:
    amenity=arts_centre:
    amenity=place_of_worship:
    amenity=theatre:
    heritage:
    other:
      query: 'nwr[historic][historic!~"^(memorial|monument|wayside_cross|wayside_shrine|building)$"]'
      trans: 'other'
